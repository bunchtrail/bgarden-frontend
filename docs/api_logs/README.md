# Инструкции по работе с логами API

## Настройка логирования API запросов

Для эффективной отладки проблем с API, связанных с добавлением растений через модуль карты, рекомендуется использовать расширенное логирование запросов.

### 1. Создание файла для логов API

```powershell
# Создать директорию для хранения логов, если она еще не существует
md docs\api_logs
```

### 2. Сохранение логов в файл

После выполнения запросов к API сохраняйте логи из консоли браузера в текстовый файл для дальнейшего анализа:

```
# Пример имени файла с датой и временем
api_log_YYYY-MM-DD_HH-MM.txt
```

## Анализ проблемы создания образцов растений

### Конфликт сервисов

В проекте существует два реализации сервиса для работы с образцами растений:

1. `src/modules/specimens/services/specimenService.ts` - основной сервис
2. `src/modules/map/services/specimenService.ts` - сервис для модуля карты

Возможно, есть конфликт в импортах или некорректное использование сервисов.

### Рекомендуемые шаги для исправления

1. **Проверить импорты в `PlantAddForm.tsx`**:
   - Убедиться, что используется правильный сервис для создания образцов
   - Проверить, что зависимости импортируются корректно

2. **Проверить аутентификацию**:
   - Проверить наличие и валидность токена в localStorage
   - Убедиться, что токен корректно включается в запросы

3. **Проверить консоль браузера**:
   - Искать ошибки CORS
   - Искать ошибки сети
   - Анализировать ответы сервера

4. **Проверить конфигурацию API**:
   - Убедиться, что API_URL корректно настроен
   - Проверить, что конечные точки API доступны

## Пример файла для сбора логов

Создайте файл для каждой сессии отладки, например:

```
docs/api_logs/specimen_creation_log_2025-03-12.txt
```

И записывайте в него информацию о:
- URL запроса
- Заголовках запроса
- Данных запроса
- Ответе сервера или ошибке

## Решение проблем с CORS

Если проблема связана с CORS, добавьте заголовки в запрос:

```typescript
const headers = {
  'Content-Type': 'application/json',
  'Accept': 'text/plain',
  'Access-Control-Allow-Origin': '*'
};
```

И проверьте настройки CORS на сервере.

## Поддержка отладки

Для дополнительной поддержки отладки, данные из API логов могут быть предоставлены команде разработки бэкенда для анализа. 