# Географический модуль для формы образцов

## Обзор

Данный модуль отвечает за отображение и управление географическими данными образцов растений в Ботаническом саду. Он включает карту с возможностью выбора позиции растения, а также формы для ввода координат и информации о происхождении.

## Компоненты

Модуль разделен на следующие компоненты:

1. **SimpleMap** - интерактивная карта с поддержкой выбора позиций и областей
2. **RegionInfo** - отображение информации о выбранном регионе
3. **CoordinatesSection** - ввод координат широты и долготы
4. **OriginSection** - выбор региона происхождения и страны
5. **AdditionalFields** - дополнительные поля для географической информации
6. **PlantsToggle** - переключатель для отображения других растений на карте
7. **utils.ts** - вспомогательные функции для работы с географическими данными

## Решение проблемы с выбором региона

### Описание проблемы

При клике на пустую область карты происходило сбрасывание выбранного региона, что вызывало ошибку валидации формы. Проблема возникала из-за следующих факторов:

1. В компоненте `MapEvents` при клике на пустую область вызывался `onAreaSelect(null)`
2. В обработчике `handleAreaSelect` обнуление области приводило к установке пустого значения для поля `regionId` в форме

### Внесенные исправления

1. **SimpleMap.tsx**: 
   - Закомментирован вызов `onAreaSelect(null)` при клике на пустую область карты в компоненте `MapEvents`
   - Улучшена проверка корректности координат в обработчике `handleAreaClick` с учетом возможных нулевых значений

2. **GeographicInfoSection.tsx**:
   - Добавлена ранняя проверка на `area === null` в начале функции `handleAreaSelect` с выходом из функции 
   - Удалена ветка `else if (area === null)`, чтобы предотвратить случайный сброс значения региона

## Рекомендации по использованию

1. **Выбор региона**: сначала выберите регион из выпадающего списка или кликните на закрашенную область на карте
2. **Выбор позиции**: кликните на любое место карты для указания точной позиции растения
3. **Координаты**: значения координат могут быть введены вручную или получены автоматически при клике на карту
4. **Отображение других растений**: используйте переключатель для отображения других растений на карте

## Примечания по отладке

В модуле предусмотрены механизмы отладки:

- Константа `ENABLE_DEBUG_LOGS` управляет выводом отладочных сообщений в консоль
- Функция `debugLog()` позволяет безопасно логировать информацию без влияния на работу в продакшене
- Константа `ENABLE_EXTRA_DOM_SYNC` включает дополнительные механизмы синхронизации с DOM для надежности работы 