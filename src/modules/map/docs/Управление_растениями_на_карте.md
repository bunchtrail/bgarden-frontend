# Управление растениями на карте

## Обзор функциональности

Модуль управления растениями предоставляет следующие возможности:

1. **Добавление нового растения на карту**:

   - Выбор местоположения на карте
   - Ввод систематических сведений о растении
   - Валидация данных
   - Сохранение растения

2. **Редактирование информации о растении**:

   - Выбор существующего растения на карте
   - Редактирование систематических сведений и других характеристик
   - Проверка и сохранение изменений

3. **Удаление растения с карты**:
   - Выбор растения на карте
   - Подтверждение удаления
   - Обновление данных на карте

## Пользовательский интерфейс

Управление растениями осуществляется через интерактивный пользовательский интерфейс, который включает:

- **Панель инструментов** - содержит кнопки для переключения между режимами:

  - Просмотр (режим по умолчанию)
  - Добавление растения
  - Редактирование растения
  - Удаление растения

- **Информационная панель** - появляется при выборе растения в режиме просмотра и отображает:

  - Русское и латинское название
  - Семейство
  - Инвентарный номер
  - Координаты
  - Кнопки для редактирования и удаления

- **Формы взаимодействия**:
  - Форма добавления растения
  - Форма редактирования растения

## Рабочий процесс

### Добавление нового растения

1. Пользователь нажимает кнопку "Добавить растение"
2. На экране появляется инструкция "Кликните на карте, чтобы выбрать место для нового растения"
3. Пользователь кликает на карте в нужном месте
4. Появляется форма для ввода данных:
   - Инвентарный номер (обязательно)
   - Русское название (обязательно)
   - Латинское название (обязательно)
   - Род
   - Вид
   - Семейство (обязательно)
   - Регион (обязательно)
5. Система проверяет корректность введенных данных
   - Если данные некорректны, отображаются сообщения об ошибках под соответствующими полями
   - Если данные корректны, растение сохраняется и отображается на карте

### Редактирование растения

1. Пользователь нажимает кнопку "Редактировать"
2. На экране появляется инструкция "Выберите растение на карте для редактирования"
3. Пользователь кликает на маркер растения на карте
4. Появляется форма редактирования с предзаполненными данными:
   - Инвентарный номер
   - Русское название
   - Латинское название
   - Род
   - Вид
   - Семейство
   - Регион
5. Пользователь изменяет необходимые данные
6. Система проверяет корректность введенных данных
   - Если данные некорректны, отображаются сообщения об ошибках под соответствующими полями
   - Если данные корректны, изменения сохраняются

### Удаление растения

1. Пользователь нажимает кнопку "Удалить"
2. На экране появляется предупреждение об удалении и инструкция "Выберите растение на карте для удаления"
3. Пользователь кликает на маркер растения на карте
4. Система запрашивает подтверждение удаления
5. Если пользователь подтверждает удаление:
   - Растение удаляется из базы данных
   - Маркер растения исчезает с карты с анимацией
   - Появляется уведомление об успешном удалении

## Валидация данных

Система выполняет следующие проверки данных:

- **Инвентарный номер**: поле не должно быть пустым
- **Русское название**: поле не должно быть пустым
- **Латинское название**: поле не должно быть пустым
- **Семейство**: должно быть выбрано из списка (не "Выберите семейство...")
- **Регион**: должен быть выбран из списка (не "Выберите регион...")

## Технические компоненты

Управление растениями реализовано следующими компонентами:

- `MapControls.tsx` - панель инструментов и навигации
- `PlantAddForm.tsx` - форма для добавления растений
- `PlantEditForm.tsx` - форма для редактирования растений
- `PlantMarker.tsx` - компонент для отображения маркера растения на карте
- `mapService.ts` - сервис для взаимодействия с API
- `MapContext.tsx` - контекст для хранения состояния карты

## Пользовательские уведомления

Система предоставляет обратную связь о выполняемых действиях:

- **Сообщения об успехе**:

  - "Растение успешно добавлено!"
  - "Растение успешно обновлено!"
  - "Растение успешно удалено!"

- **Сообщения об ошибках**:

  - "Не удалось добавить растение. Проверьте введенные данные."
  - "Не удалось обновить растение. Проверьте введенные данные."
  - "Не удалось удалить растение. Попробуйте снова позже."

- **Индикаторы загрузки**:
  - Анимация загрузки при сохранении
  - Анимация удаления маркера при удалении растения

## Режимы отображения карты

Карта ботанического сада может отображаться в двух режимах:

1. **Интерактивный вид** - полноценная интерактивная карта на базе Leaflet с возможностью масштабирования, перемещения и работы с растениями.

2. **Простой вид** - статическое изображение карты, которое также поддерживает все функции работы с растениями (добавление, редактирование, удаление).

### Работа с растениями в режиме простого изображения

В режиме простого изображения (Простой вид) доступны все те же функции, что и в интерактивном режиме:

- Добавление новых растений
- Редактирование существующих растений
- Удаление растений
- Просмотр информации о растениях

Для добавления растения в режиме простого изображения:
1. Нажмите кнопку "Добавить растение"
2. Кликните на изображение карты в том месте, где должно быть размещено растение
3. Заполните форму с информацией о растении
4. Нажмите "Сохранить"

Этот режим особенно удобен для работников ботанического сада, которые привыкли работать с традиционными схемами и планами территории.
