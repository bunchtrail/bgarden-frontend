# Структура модуля карты ботанического сада

## Обзор

Модуль карты предоставляет компоненты и сервисы для работы с интерактивной картой ботанического сада. Архитектура модуля организована по принципу разделения ответственности для облегчения поддержки и расширения.

## Структура директорий

```
map/
  ├── components/             # Компоненты пользовательского интерфейса
  │   ├── GardenMap.tsx       # Основной компонент карты
  │   ├── MapAreas.tsx        # Компонент для отображения областей на карте
  │   ├── MapControls.tsx     # Компонент элементов управления картой
  │   ├── MapSchemaUploadModal.tsx  # Модальное окно для загрузки схем карты
  │   ├── MarkerCluster.tsx   # Компонент для кластеризации маркеров
  │   ├── index.ts            # Экспорт компонентов
  │   └── map.module.css      # Стили для компонентов карты
  │
  ├── docs/                   # Документация по модулю
  │   ├── mapControllers.md   # Документация API контроллеров карты
  │   ├── mapPage.md          # Пример страницы карты
  │   ├── map_module.md       # Общая документация модуля карты
  │   └── map_module_structure.md  # Структура модуля карты (этот файл)
  │
  ├── hooks/                  # Хуки для работы с картой
  │   ├── useMap.ts           # Основной хук для работы с картой
  │   └── index.ts            # Экспорт хуков
  │
  ├── services/               # Сервисы для работы с API карты
  │   ├── map/                # Разделенные сервисы карты
  │   │   ├── markerService.ts  # Работа с маркерами
  │   │   ├── areaService.ts    # Работа с областями
  │   │   ├── schemaService.ts  # Работа со схемами карты
  │   │   ├── optionsService.ts # Работа с опциями и слоями карты
  │   │   └── index.ts        # Экспорт всех сервисов карты
  │   └── index.ts            # Экспорт всех сервисов
  │
  ├── types/                  # Типы и интерфейсы
  │   └── index.ts            # Определения всех типов для модуля карты
  │
  └── index.ts                # Основной экспорт модуля
```

## Компоненты

### GardenMap

Основной компонент, который предоставляет интерактивную карту сада с различными слоями, маркерами и областями. Поддерживает кастомные схемы карты и различные опции отображения.

### MapAreas

Компонент для отображения областей на карте (зоны растений, секторы, теплицы и т.д.).

### MapControls

Элементы управления картой: масштабирование, фильтры, переключение слоев, легенда и т.д.

### MapSchemaUploadModal

Модальное окно для загрузки пользовательской схемы карты с настройкой границ и привязкой к координатам.

### MarkerCluster

Компонент для кластеризации маркеров, что улучшает производительность при большом количестве растений.

## Сервисы

Сервисы разделены на логические модули для лучшей организации:

### markerService

Функции для работы с маркерами растений и других объектов на карте:
- Получение всех маркеров
- Получение маркера по ID
- Создание, обновление, удаление маркеров
- Фильтрация маркеров по типу или экземпляру растения
- Поиск ближайших маркеров

### areaService

Функции для работы с областями карты:
- Получение всех областей
- Получение области по ID
- Создание, обновление, удаление областей
- Фильтрация областей по типу

### schemaService

Функции для работы с пользовательскими схемами карты:
- Получение всех схем
- Получение активной схемы
- Загрузка новой схемы
- Активация/деактивация схемы
- Обновление и удаление схем

### optionsService

Функции для работы с опциями и слоями карты:
- Управление настройками отображения карты
- Работа со слоями карты

## Хуки

### useMap

Основной хук для работы с картой, предоставляющий:
- Доступ к данным маркеров, областей и слоев
- Управление фильтрами
- Поиск ближайших объектов
- Загрузку и управление данными карты

## Типы

Модуль определяет следующие основные типы данных:
- MapMarker - маркер на карте
- MapArea - область на карте
- MapLayer - слой карты
- MapOptions - опции отображения карты
- CustomMapSchema - пользовательская схема карты

Также определены DTO для создания и обновления каждой сущности. 